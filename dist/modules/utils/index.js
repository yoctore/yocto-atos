/* yocto-atos - Yocto module to make payment with Atos - Wrapper for Sips Office Json Interface - V1.0.0 */
"use strict";function Utils(a){this.logger=a}var logger=require("yocto-logger"),crypto=require("crypto"),_=require("lodash"),utf8=require("utf8");Utils.prototype.calculSEAL=function(a,b){var c="";a=_.omit(a,["keyVersion","sealAlgorithm"]),_.each(_.sortBy(_.keys(a)),function(b){return _.isObject(a[b])?void _.each(_.sortBy(_.keys(a[b])),function(d){c+=a[b][d]}):c+=a[b]}),console.log("\n --> string to hash : ",c);var d=crypto.createHmac("sha256",b);return d.update(utf8.encode(c)),d.digest("hex")},module.exports=function(a){return(_.isUndefined(a)||_.isNull(a))&&(logger.warning("[ Utils.constructor ] - Invalid logger given. Use internal logger"),a=logger),new Utils(a)};